---
layout: post
title: 巧用位运算
tags: js
---

<p>用位运算来提高程序效率早已不是新鲜事。今天看到文章，其中对于位运算的运用着实又让我眼前一亮。</p>

<p>传送门：<a href="http://blog.csdn.net/pathuang68/article/details/7567027" target="_blank">《一个百度的面试题目》</a></p>

<p>用异或找不同数，用取反和与找最低位的1，实在是让人赞不绝口！</p>

<p>想起上个月去哪儿网一面遇到一道极其类似的题，也是很多成对的数字中有一个不同的数（只有一个），当时用最笨的哈希表来做的，而且遍历了两次，第一遍存数据，第二遍找次数为1的数据。实在是笨死了。。。当时面试官告诉我第一次遍历的时候遇到两次的数据就可以从哈希表中删了，这样就不用第二次遍历了。</p>

<p>现在想来直接一遍异或就出来了，效率不知道比哈希表高了多少倍！</p>

<h3>两次取反（double-bitwise-not）以取整</h3>

<p>时隔大半年后的今天（2014-7-4），我坐在工位上看着刚刚寄来的毕业照，却写着同一篇文章，不禁心中波澜起伏感慨万千。。。回到正题，今天见到如下代码：</p>

<pre class="javascript"><code>var a = ~~a;</code></pre>

<p>这段代码的用处是去除小数部分以取整，<code>a</code>为数字、字符串都可，结果返回数字。如果<code>a</code>为正，那么结果与<code>Math.floor(a)</code>一致，如果<code>a</code>为负，那么结果与<code>Math.ceil(a)</code>一致。</p>

<p>性能方面，与<code>Math</code>系取整方法不分仲伯，毕竟是屌屌的位操作，侧面也可见<code>Math</code>系方法的高效。</p>

<p>至于两次取整的原理，是因为在js中，对浮点数取反会自动去除小数部分，所以两次取整后就变成整数了。</p>

<p>再多说两句，0按位取反是-1，1按位取反是-2，取反不是取负数，取负数是取补码（按位取反再加一），至于为什么0取反是-1，自己写一下就知道了╮(‾▽‾)╭。</p>

<h3>左移右移０位以取整</h3>

<pre class="javascript"><code>var a = a &gt;&gt; 0;	//a &lt;&lt; 0</code></pre>

<p>该方法功能与上种一样，效率也不分仲伯。</p>